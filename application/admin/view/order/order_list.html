{include file="template/_meta" /}
<title>订单列表</title>
</head>

{block name="css"}

<style type="text/css">
	body {
		background: #fff;
	}
	#page {
		width: 96%;
		height: 50px;
		line-height: 50px;
		border: solid 1px #E2E2E2;
		padding-left: 50px;
		background: #FDFDFE;
	}
	.on {
		color: #21A5FA !important;
		border-bottom: solid 3px #21A5FA;
	}
	.static_btus1 {
		width: 100px;
		height: 30px;
		line-height: 30px;
		text-align: center;
		cursor: pointer;
		margin-left: 10px
	}
	/* 没申请 */
	.not_apply {
		color: #BCBCBC;
		border: solid 1px #BCBCBC;
		border-radius: 3px;
	}
	/* 申请 */
	.apply {
		color: #FF9900;
		border: solid 1px #FF9900;
		border-radius: 3px;
	}
	/* 已开票
	 */
	.applyed {
		color: #669900;
		border: solid 1px #669900;
		border-radius: 3px;
	}
	.static_btus2 {
		width: 100px;
		height: 30px;
		line-height: 30px;
		color: #0099FF;
		cursor: pointer;
		text-align: center;
	}
	.distribution_list {
		margin-bottom: 10px;
		border-bottom: solid 1px #D7D7D7;
	}
	.distribution_list ul {
		display: flex;
		align-items: center;
	}
	.line {
		justify-content: center;
	}
	.distribution_list a {
		font-size: 14px;
		padding: 9px;
		color: #5E5E5E;
	}
	.static_btus {
		border-radius: 5px;
	}
	.state {
		width: 100px;
		height: 30px;
		line-height: 30px;
		border-radius: 4px;
		color: #fff;
		margin: 0 auto;
	}
	/*
     * 弹窗
     4*/
	.popup {
		width: 100%;
		height: 100%;
		position: fixed;
		background: rgba(0, 0, 0, 0.5);
		z-index: 99999;
		display: flex;
		justify-content: center;
		align-items: center;
		border: solid 1px #D7D7D7;
		box-sizing: border-box;
	}
	.submit_btns {
		width: 100px;
		height: 38px;
		color: #fff;
		background: #169BD5;
		border-radius: 10px;
	}
	.popup_doms {
		width: 790px;
		height: 400px;
		background: #fff;
	}
	.popup_doms1 {
		width: 900px;
		background: #fff;
	}
	.popup_content {
		padding: 20px;
	}
	.popup_title {
		height: 40px;
		line-height: 40px;
		color: #66662B;
		background: #EEF7EA;
		padding-left: 20px;
	}
	.span {
		display: inline-block;
		width: 80px;
		text-align: left;
		margin-right: 20px;
	}
	.repany .layui-input {
		width: 530px;
	}
	.repany {
		margin-bottom: 10px;
	}
	.operation {
		display: flex;
		align-items: center;
	}
	.chat {
		height: 210px;
	}
	.danhao {
		width: 200px;
		margin-right: 10px;
	}
	.operation select {
		width: 130px;
		height: 40px;
		border-color: #ABADB3;
		color: #000;
		background: #fff;
	}
	.operation div {
		margin-right: 10px;
	}
	.noshow {
		display: none;
	}
	.popup_title {
		position: relative;
	}
	.popup_x {
		width: 25px;
		position: absolute;
		right: 12px;
		top: -4px;
	}
	.repay_tip {
		display: inline-block;
		width: 100px;
		height: 35px;
		text-align: center;
		line-height: 35px;
		color: #fff;
		background: #669900;
		border-radius: 5px;
	}
	.button {
		width: 100px;
		line-height: 30px;
		text-align: center;
		border: 1px solid #a2a2a2;
		border-radius: 2px;
		cursor: pointer;
	}
	.button_all {
		display: flex;
		justify-content: space-around;
		margin-top: 30px;
		margin-bottom: 30px;
	}
	.daying {
		background: #169BD5;
		color: #fff;
	}
	/*
     * 弹窗end
		 */
	.seach_button {
		border-radius: 4px;
		display: inline-block;
		width: 80px;
		line-height: 30px;
		color: #fff;
		text-align: center;
	}
	.all0 {
		background: #F4FBFF;
		color: #999;
	}
	.all1 {
		background: #CC3366;
	}
	.all2 {
		background: #CC00CC;
	}
	.all3 {
		background: #FF0000;
	}
	.all4 {
		background: #669900;
	}
	.all5 {
		background: #A1A1A1;
		color: #000;
	}
	/* 状态颜色 */
	/* 待付款 */
	.color1 {
		background: #CC3366;
	}
	/* 待发货 */
	.color2 {
		background: #CC00CC;
	}
	/* 已发货 */
	.color3 {
		background: #FF0000;
	}
	/* 已完成 */
	.color4 {
		background: #669900;
	}
	/* 已关闭 */
	.color5 {
		background: #A1A1A1;
	}
	/* 已退款 */
	.color6 {
		background: #CC9900;
	}
	/* 已入仓 */
	.color7 {
		background: #0000CC;
	}
	/*  待发货*/
	.color8 {
		background: #CC00CC;
	}
	/* 已取消 */
	.color9 {
		background: #831626;
	}
	.chenge_money {
		display: flex;
		margin-left: 10px;
		text-align: center;
		padding-top: 20px;
		border-top: 2px dashed rgb(223, 223, 223)
	}
	.danwei {
		position: absolute;
		top: 10px;
		left: 170px;
	}
</style>

{/block}

<body>
    {block name="content"}
    <div class="popup popup_one noshow">
        <div class="popup_doms">
            <div class="popup_title">
                处理回复
                <div class="popup_x">
                    <img src="__STATIC__/admin/index/img/X.png" />
                </div>
            </div>
            <div class="popup_content">
                <div class="repany">
                    <span class="span">邮寄地址：</span>
                    <!-- <input type="text" name="" lay-verify="title" readonly autocomplete="off" placeholder="用户地址"
						class="layui-input Information"> -->
						<span class="a1"></span>
                </div>
                <div class="repany">
                    <span class="span">官方短信</span>
                    <input type="text" name="message" lay-verify="title" autocomplete="off" placeholder="请输入处理备注"
                        class="layui-input Information a11">
                </div>
                <div style="margin-left:650px;margin-top:180px;"><button  class="layui-btn one"
							style="background-color:rgb(22, 155, 213);border-radius: 5px;">确定发送</button>
				</div>
            </div>
        </div>
	</div>
	<!-- 代发货 -->
    <div class="popup popup_two noshow">
        <div class="popup_doms">
            <div class="popup_title">
                处理回复
                <div class="popup_x">
                    <img src="__STATIC__/admin/index/img/X.png" />
                </div>
            </div>
			<div class="popup_content">
                <div class="repany">
                    <span class="span">邮寄地址：</span>
                    <!-- <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="用户地址"
						class="layui-input Information"> -->
						<span class="a2"></span>
                </div>
                <div class="repany">
                    <span class="span">官方备注</span>
                    <!-- <input type="text" name="order_info" lay-verify="title" autocomplete="off" placeholder="请输入处理备注"
						class="layui-input Information"> -->
						<textarea placeholder="官方备注" class="layui-textarea"  style="min-height: 200px;" name="order_info2"></textarea>
				</div>
				<div style="margin-top: 20px;width: 100%;">
                    <div style="width:70%;float: left;padding-left:10%;">
						 <span>选择快递</span>
						 <select name="express" id="express" style="width: 100px;">
                              <option value="1" >顺丰</option>
                              <option value="2">圆通</option>
						 </select>
						 <input type="text" name="order2" placeholder="请输入快递单号" style="border: 1px solid #444;">
					</div>
					<div style="width:10%;float: left;padding-left: 10%;">
						<button class="layui-btn two"
								style="background-color:rgb(22, 155, 213);border-radius: 5px;">确定</button>
					</div>
				</div>
            </div>
        </div>
	</div>
	<!-- 已发货 -->
    <div class="popup popup_three noshow">
        <div class="popup_doms">
            <div class="popup_title">
                处理回复
                <div class="popup_x">
                    <img src="__STATIC__/admin/index/img/X.png" />
                </div>
            </div>
			<div class="popup_content">
                <div class="repany">
                    <span class="span">邮寄地址：</span>
                    <!-- <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="用户地址"
						class="layui-input Information"> -->
						<span class="a3"></span>
                </div>
                <div class="repany">
                    <span class="span">官方备注</span>
                    <!-- <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入处理备注"
						class="layui-input Information"> -->
						<textarea placeholder="官方备注" class="layui-textarea"  style="min-height: 200px;" name="order_info3"></textarea>
                </div>
                <div style="margin-top: 20px;width: 100%;">
                    <div style="width:70%;float: left;padding-left:10%;">
						 <span>选择快递</span>
						 <!-- <select name="express" id="express3" style="width: 100px;">
                              <option value="1" >顺丰</option>
                              <option value="2">圆通</option>
						 </select> -->
						 <input type="text" name="express3" readonly="readonly">
						 <input type="text" name="order3" placeholder="请输入快递单号"  readonly="readonly">
					</div>
					<div style="width:10%;float: left;padding-left: 10%;">
						<button class="layui-btn three"
								style="background-color:rgb(22, 155, 213);border-radius: 5px;">确定</button>
					</div>
				</div>
            </div>
        </div>
	</div>
	<!-- 已完成 -->
    <div class="popup popup_four noshow">
        <div class="popup_doms">
            <div class="popup_title">
                处理回复
                <div class="popup_x">
                    <img src="__STATIC__/admin/index/img/X.png" />
                </div>
            </div>
			<div class="popup_content">
                <div class="repany">
                    <span class="span">邮寄地址：</span>
                    <!-- <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="用户地址"
						class="layui-input Information"> -->
						<span class="a4">

							
						</span>
                </div>
                <div class="repany">
                    <span class="span">官方备注</span>
                    <!-- <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入处理备注"
						class="layui-input Information"> -->
						<textarea placeholder="官方备注" class="layui-textarea"  style="min-height: 200px;" name="order_info4"></textarea>
                </div>
                <div style="margin-left:650px;margin-top:180px;"><button class="layui-btn four"
							style="background-color:rgb(22, 155, 213);border-radius: 5px;">确定</button>
				</div>
            </div>
        </div>
    </div>
    <!-- <div class="popup popup_two noshow">
        <div class="popup_doms1">
            <div id="dvMain">
                <div class="popup_title">
                    订单基本信息
                    <div class="popup_x">
                        <img src="__STATIC__/admin/index/img/X.png" />
                    </div>
                </div>
                <div class="popup_content1" id="">

                </div>
            </div>
            <div class="button_all">
                <div class="quxiao button">取消</div>
                <div class="daying button">打印</div>
            </div>
        </div>
    </div> -->
    <div class="childrenBody">
        {include file="template/_top" /}
        <!--<div class="distribution_list">-->
        <!--<ul>-->
        <!--<li>-->
        <!--<a href="order_index" class="on" style="text-decoration:none;">初始订单</a>-->
        <!--</li>-->
        <!--<li>-->
        <!--<a href="order_integral" style="text-decoration:none;">积分订单</a>-->
        <!--</li>-->

        <!--</ul>-->
        <!--</div>-->
        <blockquote class="layui-elem-quote news_search">
            <form class="layui-form" action="{:url('admin/Order/order_list')}">
                <div class="seach">
                    <div class="seach_list">
                        <div class="seach_laber">请搜索：</div>
                        <div class="seach_input">
                            <input type="text" name="order_number" lay-verify="title" autocomplete="off"
                                placeholder="订单编号/商品名称/用户账号" class="layui-input">
                        </div>
                    </div>
                    <!--<div class="seach_list">-->
                    <!--<div class="seach_laber">商品名称：</div>-->
                    <!--<div class="seach_input">-->
                    <!--<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="" class="layui-input">-->
                    <!--</div>-->
                    <!--</div>-->

                    <!-- <div class="seach_list">
                        <div class="seach_laber">订单类型：</div>
                        <div class="seach_input">
                            <select name="order_type">
                                <option value="0" selected="">全部</option>
                                <option value="1">选择直邮</option>
                                <option value="2">到店自提</option>
                                <option value="3">选择存茶</option>
                            </select>
                        </div>
                    </div> -->
                    
                    <!--<div class="seach_list">-->
                    <!--<div class="seach_laber">订单状态：</div>-->
                    <!--<div class="seach_input">-->
                    <!--<select name="">-->
                    <!--<option value="-1" selected="">全部</option>-->
                    <!--<option value="0">已关闭</option>-->
                    <!--<option value="1">待支付</option>-->
                    <!--<option value="2">已付款</option>-->
                    <!--<option value="3">待发货</option>-->
                    <!--<option value="4">已发货</option>-->
                    <!--<option value="5">待收货</option>-->
                    <!--<option value="6">已收货</option>-->
                    <!--<option value="7">待评价</option>-->
                    <!--<option value="8">已完成</option>-->
                    <!--<option value="9">未付款取消订单</option>-->
                    <!--<option value="10">已付款取消订单</option>-->
                    <!--<option value="11">退货</option>-->
                    <!--</select>-->
                    <!--</div>-->
                    <!--</div>-->
                    <!--<div class="seach_list">-->
                    <!--<div class="seach_laber">用户账号：</div>-->
                    <!--<div class="seach_input">-->
                    <!--<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="" class="layui-input">-->
                    <!--</div>-->
                    <!--</div>-->
                    <div class="seach_list">
                        <div class="seach_laber">开始时间</div>
                        <div class="seach_input">
                            <span class="time">
                                <input name="order_create_time" type="text" class="text datetimepicker layui-input"
                                    readonly="readonly" id="beginTime" value="">
                            </span>
                        </div>
                    </div>
                    <div class="seach_list">
                        <div class="seach_laber">结束时间</div>
                        <div class="seach_input">
                            <span class="time">
                                <input name="order_end_time" type="text" class=" text datetimepicker layui-input"
                                    readonly="readonly" id="endTime" value="">
                            </span>
                        </div>
                    </div>
                    <button class="layui-btn" type="submit" id="seach">立即搜索</button>
                </div>
            </form>
        </blockquote>
        <div class="seach_button_all">
            <a href="{:url('admin/Order/order_status',['order_type'=>10])}" class="seach_button all0">全部</a>
            <a href="{:url('admin/Order/order_status',['order_type'=>1])}" class="seach_button all1">待确定</a>
            <a href="{:url('admin/Order/order_status',['order_type'=>2])}" class="seach_button all2">待发货</a>
            <a href="{:url('admin/Order/order_status',['order_type'=>3])}" class="seach_button all3">已发货</a>
			<a href="{:url('admin/Order/order_status',['order_type'=>4])}" class="seach_button all4">已完成</a>
        </div>
        <div class="layui-form news_list">
            <table class="layui-table">
                <colgroup>
                    <col width="3%">
                </colgroup>
                <thead>
                    <tr>
                        <th><input type="checkbox" sname="" lay-skin="primary" lay-filter="allChoose" id="id"></th>
                        <th>订单号</th>
                        <th>商品图片</th>
                        <th>商品名称</th>
                        <th>商品金额</th>
                        <th>订单数量</th>
                        <th>用户账号</th>
                        <th>时间</th>
                        <!-- <th>用户总订单金额</th> -->
                        <th>订单状态</th>
                    </tr>
                </thead>
                <tbody class="news_content">
                    {if !empty($data)}
                    {volist name="data" id="vo"}
                    <tr>
                        <td><input type="checkbox" sname="" lay-skin="primary" lay-filter="choose" data-id="{$vo.id}">
                        </td>
                        <td>
                            {$vo.order_number}
                        </td>
                        {if !empty($vo["goods_image"])}
                        <td class="">
                            <div class="tdimg"><img src="{$vo.goods_image}" /></div>
                        </td>
                        {else}
                        <td class="">
                            无
                        </td>
                        {/if}
                        <td>
                            <div class="overflow">{$vo.goods_name}</div>
                        </td>
                        <td>{$vo.goods_money}</td>
                        <td>1</td>
                        <td>{$vo.user_account_name}</td>
                        <td>{$vo.create_time|date="Y-m-d H:i:s",###}</td>
                        <!-- <td>{$vo.goods_money}</td> -->
                        <td>
                            <div class="line">
                                <div class="static_btus" data-id="{$vo.id}" data-value="{$vo.order_type}">
                                    {$vo.order_type|show_order_status}
                                </div>
                            </div>
                        </td>
                    </tr>
                    {/volist}
                    {/if}
                </tbody>
            </table>
            <div id="page">
                <div class="opation" style="width: 200px; float: left;">
                    <select name="" style="color: #C1A5A5; border-color: #E4E4E4;height: 30px;">
                        <option check="" value="0">请选择</option>
                        <option value="1">批量删除</option>
                    </select>
                </div>
                <div style="float: left; height: 52px;line-height: 52px; margin-left: 20px;">
                    <button type="button" id="opration_btu"
                        style="width: 60px; background: #fff; color: #333333;border:#CCCCCC solid 1px;height: 38px;line-height: 38px;">确定
                    </button>
				</div>
				{$listpage}
            </div>
        </div>
    </div>

	{/block}

	<!--_footer 作为公共模版分离出去-->
	{include file="template/_footer" /}
	<!--/_footer 作为公共模版分离出去-->

	<!--请在下方写此页面业务相关的脚本-->
	{block name="bottom"}
	<script type="text/javascript">
		layui.config({
			base: "js/"
		}).use(['form', 'layer', 'jquery', 'laypage'], function () {
			var form = layui.form(),
				layer = parent.layer === undefined ? layui.layer : parent.layer,
				laypage = layui.laypage,
				$ = layui.jquery;
			var vals = $("input").data("id");
			//点击操作确认按钮
			var data_id = [];
			$("#opration_btu").click(function () {
				var opration_val = $(".opation select option:selected").val();
				if (opration_val == 0) {
					layer.alert('请选择操作', {
						skin: 'layui-layer-molv' //样式类名
						,
						closeBtn: 0
					});
				} else if (opration_val == 1) {
					layer.confirm('你确认要删除吗？', {
						btn: ['确认', '取消'] //按钮
					}, function (index) {
						layer.close(index);
						var child = $("tbody").find('input[type="checkbox"]:not([name="show"]):checked');
						for (var i = 0; i < child.length; i++) {
							data_id.push($(child[i])[0].dataset.id);
						}
						$.ajax({
							type: "POST",
							url: "{:url('admin/Order/order_del')}",
							data: {
								"id": data_id,
							},
							success: function (data) {
								console.log("成功");
								console.log(data);
								var data = $.parseJSON(data);
								layer.alert(data.info, {
									skin: 'layui-layer-molv' //样式类名
									,
									closeBtn: 0
								});
								location.reload();
								data_id.splice(0, data_id.length);
							},
							error: function (data) {
								var data = $.parseJSON(data);
								layer.alert(data.info, {
									skin: 'layui-layer-molv' //样式类名
									,
									closeBtn: 0
								});
								console.log(data);
								console.log("错误");
								data_id.splice(0, data_id.length);
							}
						});
					});

				}

			});

			//全选
			form.on('checkbox(allChoose)', function (data) {
				var child = $(data.elem).parents('table').find('tbody input[lay-skin="primary"]:not([name="show"])');
				child.each(function (index, item) {
					item.checked = data.elem.checked;
				});
				form.render('checkbox');
			});
			//通过判断文章是否全部选中来确定全选按钮是否选中
			form.on("checkbox(choose)", function (data) {
				// console.log($(data.elem).parents('table').find('thead input[lay-filter="allChoose"]').get(0))
				var child = $(data.elem).parents('table').find('tbody input[lay-skin="primary"]:not([name="show"])');
				var childChecked = $(data.elem).parents('table').find('tbody input[lay-skin="primary"]:not([name="show"]):checked');
				if (childChecked.length === child.length) {
					$(data.elem).parents('table').find('thead input[lay-filter="allChoose"]').get(0).checked = true;
				} else {
					$(data.elem).parents('table').find('thead input[lay-filter="allChoose"]').get(0).checked = false;
				}
				form.render('checkbox');
			})

			form.on('switch(isShow)', function (data) {
				if ($(this).val() == 0) {
					$(this).val(1);
				} else {
					$(this).val(0);
				}
				var vals = data.value;
				var id = $(this).data("id");
				var status = $(this).val();
				$.ajax({
					type: "POST",
					url: "{:url('')}",
					data: {
						"id": id,
						"status": status
					},
					success: function (data) {
						console.log("成功")
					},
					error: function (data) {
						console.log("错误")
					}
				});

			})
		})
		//订单状态---弹窗时间
		$(".static_btus").click(function () {
			var data_id = $(this).data("id");   //订单id
			var data_value = $(this).data("value");   //订单状态
			if(data_value=='1')
			{       //待确定订单
			    //获取订单的信息
				$.ajax({
					url:"get_orderinfo",
					type:"post",
					data:{"id":data_id
					},
					success : function(data)
					{
						var json=eval("("+data+")");
						$('.popup_one').find('.a1').text(json.data.address);
						$('.popup_one').find('.a11').val(json.data.message);
						$('.popup_one').append('<input type="hidden" name="phone1" value="'+json.data.phone+'" class="phone"> ' );
						$('.popup_one').append('<input type="hidden" name="order_number1" value="'+json.data.order_number+'" class="phone"> ' );
						$('.popup_one').append('<input type="hidden" name="express_id" value="'+json.data.express_id+'" class="express"> ' );
					}
				})
				$(".popup_one").removeClass("noshow");

			}else if(data_value=='2'){    //待发货
			 //获取订单的信息
			 $.ajax({
					url:"get_orderinfo",
					type:"post",
					data:{"id":data_id
					},
					success : function(data)
					{
						var json=eval("("+data+")");
						$('.popup_two').find('.a2').text(json.data.address);
				        $('.popup_two').append('<input type="hidden" name="phone2" value="'+json.data.phone+'" class="phone"> ' );
				        $('.popup_two').append('<input type="hidden" name="order_number2" value="'+json.data.order_number+'" class="phone"> ' );
				        $('.popup_two').append('<input type="hidden" name="address_id2" value="'+json.data.address_id+'" class="phone"> ' );
					}
				})
                $(".popup_two").removeClass("noshow");


			}else if(data_value=='3'){    //已发货
				//获取订单的信息
				$.ajax({
						url:"get_orderinfo",
						type:"post",
						data:{"id":data_id
						},
						success : function(data)
						{
							var json=eval("("+data+")");
							$('.popup_three').find('.a3').text(json.data.address);
							$('.popup_three').find('textarea[name="order_info3"]').val(json.data.order_info);
							$('.popup_three').find('input[name="order3"]').val(json.data.express_number);
							$('.popup_three').find('input[name="express3"]').val(json.data.express_name);
							$('.popup_three').append('<input type="hidden" name="express_id3" value="'+json.data.express_id+'" class="express"> ' );
							$('.popup_two').append('<input type="hidden" name="order_number3" value="'+json.data.order_number+'" class="phone"> ' );
							$('.popup_two').append('<input type="hidden" name="address_id3" value="'+json.data.address_id+'" class="phone"> ' );
						}
					})
				$(".popup_three").removeClass("noshow");


			}else if(data_value=='4'){     //已完成
			 //获取订单的信息
			 $.ajax({
					url:"get_orderinfo",
					type:"post",
					data:{"id":data_id
					},
					success : function(data)
					{
						var json=eval("("+data+")");
						$('.popup_four').find('.a4').text(json.data.harvester_address);
					}
				})
			    $(".popup_four").removeClass("noshow");

			}else{
				alert('获取订单状态出错');
				return false;
			}

			

		});
		//状态弹窗隐藏
		$(".popup_x").click(function () {
			$(".popup").addClass("noshow");
		});
		$(".operation").on("click", ".submit_btns", function () {
			$(".popup").addClass("noshow");
			var repay = $(".repay").val();
			var id = $(this).parent(".operation").data("id");
			var value = $(this).parent(".operation").data("value");

			//    快递选择
			var curier = $(".curier option:selected").val();
			//    操作选择
			var operation_select = $(".operation_select option:selected").val();
			//    单号
			var danhao = $(".danhao").val();
			if (danhao != '') {
				$.ajax({
					type: "POST",
					url: "{:url('admin/Order/order_confirm_shipment')}",
					data: {
						"order_id": value,
						"courier_number": danhao,
						"status": 5,
						"express_name": curier
					},
					success: function (data) {
						location.reload();
						var data = eval('(' + data + ')');
						console.log(data);

					},
					error: function (data) {

					}
				});

			}
			else {
				alert("请输入单号");
			}

		});
		// 点击订单详情
		$(".static_btus2").click(function () {
			$(".popup_two").removeClass("noshow");
			$(".popup_content1").empty();
			var data_id = $(this).data("id");
			$.ajax({
				type: "POST",
				url: "{:url('admin/Order/order_information_return')}",
				data: {
					"order_id": data_id,
				},
				async: false,
				success: function (data) {
					var data = eval('(' + data + ')');
					console.log(data);
					var dhtm9 = "";
					dhtm9 += '<table class="layui-table">';
					dhtm9 += '<tbody class="news_content">';
					dhtm9 += '	<tr>';
					dhtm9 += '	<td>用户账号：</td>';
					dhtm9 += '<td>' + data.data.user_account_name + '</td>';
					dhtm9 += '<td>订单号：</td>';
					dhtm9 += '<td>' + data.data.parts_order_number + '</td>';
					dhtm9 += '</tr>';
					dhtm9 += '<tr>';
					dhtm9 += '<td>商品名称：</td>';
					dhtm9 += '<td>' + data.data.parts_goods_name + '</td>';
					dhtm9 += '<td>商品数量：</td>';
					dhtm9 += '<td>' + data.data.order_quantity + '</td>';
					dhtm9 += '</tr>';
					dhtm9 += '<tr>';
					dhtm9 += '<td>下单时间：</td>';
					dhtm9 += '<td>' + data.data.order_create_time + '</td>';
					dhtm9 += '<td>订单金额：</td>';
					dhtm9 += '<td>' + data.data.order_amount + '</td>';
					dhtm9 += '	</tr>';
					dhtm9 += '<tr>';
					dhtm9 += '<td>订单类型：</td>';
					dhtm9 += '<td>' + data.data.order_type + '</td>';
					dhtm9 += '<td>订单配送费用：</td>';
					dhtm9 += '<td>' + data.data.goods_franking + ' </td>';
					dhtm9 += '	</tr>';
					dhtm9 += '	<tr>';
					dhtm9 += '<td>订单税费：</td>';
					dhtm9 += '<td>13922830809</td>';
					dhtm9 += '<td>仓储保险费：</td>';
					dhtm9 += '	<td>2018062803890</td>';
					dhtm9 += '</tr>';
					dhtm9 += '<tr>';
					dhtm9 += '<td>优惠劵：</td>';
					dhtm9 += '<td>13922830809</td>';
					dhtm9 += '<td>仓储地址：</td>';
					dhtm9 += '	<td>2018062803890</td>';
					dhtm9 += '</tr>';
					dhtm9 += '<tr>';
					dhtm9 += '	<td>配送地址：</td>';
					dhtm9 += '<td>' + data.data.harvester_address + '</td>';
					dhtm9 += '<td>收货人信息：</td>';
					dhtm9 += '<td>收件人：' + data.data.harvester + '联系电话：' + data.data.harvest_phone_num + '</td>';
					dhtm9 += '	</tr>';
					dhtm9 += '</tbody>';
					dhtm9 += '	</table>';
					$(".popup_content1").append(dhtm9);
				},
				error: function (data) {
				}
			});


		})
		// 点击申请开票
		// 点击批注

		$(".repay_tip").click(function () {
			var data_id = $(this).data("value")
			var Information = $(".Information").val();
			if (Information != '') {
				$.ajax({
					type: "POST",
					url: "{:url('admin/Notification/option_add_notice')}",
					data: {
						"order_id": data_id,
						"information": Information,
					},
					async: false,
					success: function (data) {
						var data = eval('(' + data + ')');
						var dhtm0 = "";
						dhtm0 += '<div class="chat_list">';
						dhtm0 += '	<span class="span">' + timestampToTime(data.data.create_time) + '</span>';
						dhtm0 += '<span>' + data.data.information + '</span>';
						dhtm0 += '</div>';
						$(".chat").append(dhtm0);
						$(".Information").val("");

					},
					error: function (data) {

					}
				});

			}
			else {
				alert("批注不能为空");
			}
		});
		$(".button").click(function () {
			$(".popup").addClass("noshow");
		});
		$('.daying').click(function testprint() {
			var headstr = "<html><head><title></title></head><body>";
			var footstr = "</body>";
			var printData = document.getElementById("dvMain").innerHTML;
			// var printMain = document.getElementById("dvMain").innerHTML;
			var oldstr = document.body.innerHTML;
			document.body.innerHTML = headstr + printData  + footstr;
			window.print();
			document.body.innerHTML = oldstr;
		})

		function timestampToTime(timestamp) {
			var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
			Y = date.getFullYear();
			M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1);
			D = date.getDate();
			h = date.getHours() + ':';
			m = date.getMinutes() + ':';
			s = date.getSeconds();
			return Y + M + D;
		}
		//one点击事件待确定
		$('.one').click(function(){
			var mes=$('.one').parent().prev().find('.a11').val();
			var phone=$('input[name="phone1"]').val();
			if(phone==0)
			{
				alert('请填写用户地址');
				return false;
			}
			$.ajax({
				url:'send_message',
				type:"post",
				data:{mes:mes,phone:phone},
				success : function(data)
				{
					var data = eval('(' + data + ')');
					if(data.status=='1')
					{
						alert('短信提醒成功');
						window.location.reload();
					}else{
						alert(data.info);
						window.location.reload();
					}
				}
			})
		})
		//two点击事件待确定-----代发货
		$('.two').click(function(){
			var phone=$('input[name="phone2"]').val();   
			if(phone==0)      //判断用户是否有默认的收货地址
			{
				alert('请新增用户地址');
				return false;
			}
			var order_info=$('textarea[name="order_info2"]').val();
			var express=$('#express').find('option:selected').val();
			var order=$('input[name="order2"]').val();    //快递订单号
			var order_number=$('input[name="order_number2"]').val();
			var address_id=$('input[name="address_id2"]').val();
			if(address_id=='0')
			{
				alert('请新增用户地址');
				return false;
			}else{

			}
			$.ajax({
				url:'order_save',
				type:"post",
				data:{order_info:order_info,
				      phone:phone,
					  order:order,
					  order_number:order_number,
					  address_id:address_id,
					  express:express
				},
				success : function(data)
				{
					var data = eval('(' + data + ')');
					if(data.status=='1')
					{
						alert(data.info);
						window.location.reload();
					}else{
						alert(data.info);
						window.location.reload();
					}
				}
			})
		})
		//three点击事件待确定-----已发货
		$('.three').click(function(){
			var phone=$('input[name="phone2"]').val();   
			if(phone==0)      //判断用户是否有默认的收货地址
			{
				alert('请新增用户地址');
				return false;
			}
			var order_info=$('textarea[name="order_info3"]').val();
			var express=$('input[name="express_id3"]').val();
			var order=$('input[name="order3"]').val();    //快递订单号
			var order_number=$('input[name="order_number3"]').val();
			var address_id=$('input[name="address_id3"]').val();
			if(address_id=='0')
			{
				alert('请新增用户地址');
				return false;
			}else{

			}
			$.ajax({
				url:'order_save',
				type:"post",
				data:{order_info:order_info,
				      phone:phone,
					  order:order,
					  order_number:order_number,
					  address_id:address_id,
					  express:express
				},
				success : function(data)
				{
					var data = eval('(' + data + ')');
					if(data.status=='1')
					{
						alert(data.info);
						window.location.reload();
					}else{
						alert(data.info);
						window.location.reload();
					}
				}
			})
		})
		
	
	</script>

	{/block}

</body>

</html>